import{r as i,f as k,g as B,j as f,c as b,d as re,Z as te,u as Y,E as ne,M as oe,b as j}from"./index.5678593b.js";const H=["mousedown","touchstart"];function se(t,e,r){const n=i.exports.useRef();return i.exports.useEffect(()=>{const o=s=>{var a;if(Array.isArray(r)){const u=(a=s==null?void 0:s.target)==null?void 0:a.hasAttribute("data-ignore-outside-clicks");r.every(c=>!!c&&!c.contains(s.target))&&!u&&t()}else n.current&&!n.current.contains(s.target)&&t()};return(e||H).forEach(s=>document.addEventListener(s,o)),()=>{(e||H).forEach(s=>document.removeEventListener(s,o))}},[n,t,r]),n}const I={xs:1,sm:2,md:3,lg:4,xl:5};function C(t,e){const r=t.fn.variant({variant:"outline",color:e}).border;return e in t.colors?r:e===void 0?t.colorScheme==="dark"?t.colors.dark[4]:t.colors.gray[4]:e}var ie=k((t,{size:e,variant:r,color:n})=>({root:{},withLabel:{borderTop:"0 !important"},left:{"&::before":{display:"none"}},right:{"&::after":{display:"none"}},label:{display:"flex",alignItems:"center","&::before":{content:'""',flex:1,height:1,borderTop:`${t.fn.size({size:e,sizes:I})}px ${r} ${C(t,n)}`,marginRight:t.spacing.xs},"&::after":{content:'""',flex:1,borderTop:`${t.fn.size({size:e,sizes:I})}px ${r} ${C(t,n)}`,marginLeft:t.spacing.xs}},labelDefaultStyles:{color:n==="dark"?t.colors.dark[1]:t.fn.themeColor(n,t.colorScheme==="dark"?5:t.fn.primaryShade(),!1)},horizontal:{border:0,borderTopWidth:t.fn.size({size:e,sizes:I}),borderTopColor:C(t,n),borderTopStyle:r,margin:0},vertical:{border:0,alignSelf:"stretch",height:"100%",borderLeftWidth:t.fn.size({size:e,sizes:I}),borderLeftColor:C(t,n),borderLeftStyle:r}})),ae=ie,ce=Object.defineProperty,ue=Object.defineProperties,le=Object.getOwnPropertyDescriptors,M=Object.getOwnPropertySymbols,Z=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable,L=(t,e,r)=>e in t?ce(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,V=(t,e)=>{for(var r in e||(e={}))Z.call(e,r)&&L(t,r,e[r]);if(M)for(var r of M(e))G.call(e,r)&&L(t,r,e[r]);return t},de=(t,e)=>ue(t,le(e)),ge=(t,e)=>{var r={};for(var n in t)Z.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&M)for(var n of M(t))e.indexOf(n)<0&&G.call(t,n)&&(r[n]=t[n]);return r};const fe={orientation:"horizontal",size:"xs",labelPosition:"left",variant:"solid"},pe=i.exports.forwardRef((t,e)=>{const r=B("Divider",fe,t),{className:n,color:o,orientation:s,size:a,label:u,labelPosition:l,labelProps:c,variant:d,styles:g,classNames:v,unstyled:p}=r,x=ge(r,["className","color","orientation","size","label","labelPosition","labelProps","variant","styles","classNames","unstyled"]),{classes:h,cx:D}=ae({color:o,size:a,variant:d},{classNames:v,styles:g,unstyled:p,name:"Divider"}),m=s==="vertical",O=s==="horizontal",w=!!u&&O,y=!(c!=null&&c.color);return f(b,{...V({ref:e,className:D(h.root,{[h.vertical]:m,[h.horizontal]:O,[h.withLabel]:w},n)},x),children:w&&f(re,{...de(V({},c),{size:(c==null?void 0:c.size)||"xs",sx:{marginTop:2},className:D(h.label,h[l],{[h.labelDefaultStyles]:y})}),children:u})})});pe.displayName="@mantine/core/Divider";const he=te({"from, to":{opacity:.4},"50%":{opacity:1}});var ve=k((t,{height:e,width:r,radius:n,circle:o,animate:s})=>({root:{height:e,width:o?e:r,borderRadius:o?e:t.fn.radius(n),position:"relative",overflow:"hidden"},visible:{"&::before":{content:'""',position:"absolute",background:t.colorScheme==="dark"?t.colors.dark[7]:t.white,top:0,bottom:0,left:0,right:0,zIndex:10},"&::after":{content:'""',position:"absolute",background:t.colorScheme==="dark"?t.colors.dark[4]:t.colors.gray[3],top:0,bottom:0,left:0,right:0,animation:s?`${he} 1500ms linear infinite`:"none",zIndex:11}}})),be=ve,De=Object.defineProperty,T=Object.getOwnPropertySymbols,J=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable,A=(t,e,r)=>e in t?De(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,me=(t,e)=>{for(var r in e||(e={}))J.call(e,r)&&A(t,r,e[r]);if(T)for(var r of T(e))Q.call(e,r)&&A(t,r,e[r]);return t},Se=(t,e)=>{var r={};for(var n in t)J.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&T)for(var n of T(t))e.indexOf(n)<0&&Q.call(t,n)&&(r[n]=t[n]);return r};const xe={height:"auto",width:"100%",visible:!0,animate:!0},X=i.exports.forwardRef((t,e)=>{const r=B("Skeleton",xe,t),{height:n,width:o,visible:s,animate:a,className:u,circle:l,radius:c,unstyled:d}=r,g=Se(r,["height","width","visible","animate","className","circle","radius","unstyled"]),{classes:v,cx:p}=be({height:n,width:o,circle:l,radius:c,animate:a},{unstyled:d,name:"Skeleton"});return f(b,{...me({className:p(v.root,{[v.visible]:s},u),ref:e},g)})});X.displayName="@mantine/core/Skeleton";function Oe(){const[t,e]=i.exports.useState(!1),r=navigator.userAgent.toLowerCase(),n=i.exports.useMemo(()=>["iphone","ipad","ipod","android","linux","windows phone"],[]);return i.exports.useEffect(()=>{n.forEach(o=>{r.indexOf(o)!==-1&&e(!0)})},[]),t}function we({url:t,width:e,originWidth:r,flowWidthRef:n,position:o}){var u,l,c;const[s,a]=i.exports.useState();return Y(),i.exports.useEffect(()=>{let d;return n&&(d=new ResizeObserver(()=>{a(n==null?void 0:n.clientWidth)}),d.observe(n)),()=>{n&&d.disconnect()}},[n]),f(b,{sx:{width:s!=null?s:e,height:s!=null?s:e,position:"relative",userSelect:"none",pointerEvents:"none"},children:o?f(b,{sx:{transform:"scale("+((u=s!=null?s:e)!=null?u:0)/r+")",position:"absolute",top:(((l=s!=null?s:e)!=null?l:0)-r)/2,left:(((c=s!=null?s:e)!=null?c:0)-r)/2,width:r+"px",height:r+"px",backgroundRepeat:"no-repeat",backgroundImage:"url("+t+")",backgroundPosition:o[0]+"px "+o[1]+"px"}}):f(X,{sx:{height:"100%"},visible:!0})})}function ye({imgKey:t,width:e=90,flowWidthRef:r}){const{imgPositionMap:n}=ne();return f(we,{url:"https://img.yituliu.site/static/char_0.5.webp",width:e,originWidth:90,flowWidthRef:r,position:n.avatarImgPosition[t]})}const Pe=i.exports.createContext({dragDropManager:void 0});function S(t,e,...r){if(Ie()&&e===void 0)throw new Error("invariant requires an error message argument");if(!t){let n;if(e===void 0)n=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{let o=0;n=new Error(e.replace(/%s/g,function(){return r[o++]})),n.name="Invariant Violation"}throw n.framesToPop=1,n}}function Ie(){return typeof process!="undefined"&&process.env.NODE_ENV==="production"}var Ce=function t(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var n,o,s;if(Array.isArray(e)){if(n=e.length,n!=r.length)return!1;for(o=n;o--!==0;)if(!t(e[o],r[o]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(s=Object.keys(e),n=s.length,n!==Object.keys(r).length)return!1;for(o=n;o--!==0;)if(!Object.prototype.hasOwnProperty.call(r,s[o]))return!1;for(o=n;o--!==0;){var a=s[o];if(!t(e[a],r[a]))return!1}return!0}return e!==e&&r!==r};const P=typeof window!="undefined"?i.exports.useLayoutEffect:i.exports.useEffect;function Me(t,e,r){const[n,o]=i.exports.useState(()=>e(t)),s=i.exports.useCallback(()=>{const a=e(t);Ce(n,a)||(o(a),r&&r())},[n,t,r]);return P(s),[n,s]}function Te(t,e,r){const[n,o]=Me(t,e,r);return P(function(){const a=t.getHandlerId();if(a!=null)return t.subscribeToStateChange(o,{handlerIds:[a]})},[t,o]),n}function _e(t,e,r){return Te(e,t||(()=>({})),()=>r.reconnect())}function Ee(t,e){const r=[...e||[]];return e==null&&typeof t!="function"&&r.push(t),i.exports.useMemo(()=>typeof t=="function"?t():t,r)}function ke(t){return i.exports.useMemo(()=>t.hooks.dragSource(),[t])}function Re(t){return i.exports.useMemo(()=>t.hooks.dragPreview(),[t])}let _=!1,E=!1;class Ne{receiveHandlerId(e){this.sourceId=e}getHandlerId(){return this.sourceId}canDrag(){S(!_,"You may not call monitor.canDrag() inside your canDrag() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return _=!0,this.internalMonitor.canDragSource(this.sourceId)}finally{_=!1}}isDragging(){if(!this.sourceId)return!1;S(!E,"You may not call monitor.isDragging() inside your isDragging() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return E=!0,this.internalMonitor.isDraggingSource(this.sourceId)}finally{E=!1}}subscribeToStateChange(e,r){return this.internalMonitor.subscribeToStateChange(e,r)}isDraggingSource(e){return this.internalMonitor.isDraggingSource(e)}isOverTarget(e,r){return this.internalMonitor.isOverTarget(e,r)}getTargetIds(){return this.internalMonitor.getTargetIds()}isSourcePublic(){return this.internalMonitor.isSourcePublic()}getSourceId(){return this.internalMonitor.getSourceId()}subscribeToOffsetChange(e){return this.internalMonitor.subscribeToOffsetChange(e)}canDragSource(e){return this.internalMonitor.canDragSource(e)}canDropOnTarget(e){return this.internalMonitor.canDropOnTarget(e)}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(e){this.sourceId=null,this.internalMonitor=e.getMonitor()}}function Xe(t,e,r){const n=r.getRegistry(),o=n.addTarget(t,e);return[o,()=>n.removeTarget(o)]}function ze(t,e,r){const n=r.getRegistry(),o=n.addSource(t,e);return[o,()=>n.removeSource(o)]}function U(t,e,r,n){let o=r?r.call(n,t,e):void 0;if(o!==void 0)return!!o;if(t===e)return!0;if(typeof t!="object"||!t||typeof e!="object"||!e)return!1;const s=Object.keys(t),a=Object.keys(e);if(s.length!==a.length)return!1;const u=Object.prototype.hasOwnProperty.bind(e);for(let l=0;l<s.length;l++){const c=s[l];if(!u(c))return!1;const d=t[c],g=e[c];if(o=r?r.call(n,d,g,c):void 0,o===!1||o===void 0&&d!==g)return!1}return!0}function F(t){return t!==null&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function $e(t){if(typeof t.type=="string")return;const e=t.type.displayName||t.type.name||"the component";throw new Error(`Only native element nodes can now be passed to React DnD connectors.You can either wrap ${e} into a <div>, or turn it into a drag source or a drop target itself.`)}function je(t){return(e=null,r=null)=>{if(!i.exports.isValidElement(e)){const s=e;return t(s,r),s}const n=e;return $e(n),Le(n,r?s=>t(s,r):t)}}function He(t){const e={};return Object.keys(t).forEach(r=>{const n=t[r];if(r.endsWith("Ref"))e[r]=t[r];else{const o=je(n);e[r]=()=>o}}),e}function q(t,e){typeof t=="function"?t(e):t.current=e}function Le(t,e){const r=t.ref;return S(typeof r!="string","Cannot connect React DnD to an element with an existing string ref. Please convert it to use a callback ref instead, or wrap it into a <span> or <div>. Read more: https://reactjs.org/docs/refs-and-the-dom.html#callback-refs"),r?i.exports.cloneElement(t,{ref:n=>{q(r,n),q(e,n)}}):i.exports.cloneElement(t,{ref:e})}class Ve{receiveHandlerId(e){this.handlerId!==e&&(this.handlerId=e,this.reconnect())}get connectTarget(){return this.dragSource}get dragSourceOptions(){return this.dragSourceOptionsInternal}set dragSourceOptions(e){this.dragSourceOptionsInternal=e}get dragPreviewOptions(){return this.dragPreviewOptionsInternal}set dragPreviewOptions(e){this.dragPreviewOptionsInternal=e}reconnect(){const e=this.reconnectDragSource();this.reconnectDragPreview(e)}reconnectDragSource(){const e=this.dragSource,r=this.didHandlerIdChange()||this.didConnectedDragSourceChange()||this.didDragSourceOptionsChange();return r&&this.disconnectDragSource(),this.handlerId?e?(r&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragSource=e,this.lastConnectedDragSourceOptions=this.dragSourceOptions,this.dragSourceUnsubscribe=this.backend.connectDragSource(this.handlerId,e,this.dragSourceOptions)),r):(this.lastConnectedDragSource=e,r):r}reconnectDragPreview(e=!1){const r=this.dragPreview,n=e||this.didHandlerIdChange()||this.didConnectedDragPreviewChange()||this.didDragPreviewOptionsChange();if(n&&this.disconnectDragPreview(),!!this.handlerId){if(!r){this.lastConnectedDragPreview=r;return}n&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragPreview=r,this.lastConnectedDragPreviewOptions=this.dragPreviewOptions,this.dragPreviewUnsubscribe=this.backend.connectDragPreview(this.handlerId,r,this.dragPreviewOptions))}}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didConnectedDragSourceChange(){return this.lastConnectedDragSource!==this.dragSource}didConnectedDragPreviewChange(){return this.lastConnectedDragPreview!==this.dragPreview}didDragSourceOptionsChange(){return!U(this.lastConnectedDragSourceOptions,this.dragSourceOptions)}didDragPreviewOptionsChange(){return!U(this.lastConnectedDragPreviewOptions,this.dragPreviewOptions)}disconnectDragSource(){this.dragSourceUnsubscribe&&(this.dragSourceUnsubscribe(),this.dragSourceUnsubscribe=void 0)}disconnectDragPreview(){this.dragPreviewUnsubscribe&&(this.dragPreviewUnsubscribe(),this.dragPreviewUnsubscribe=void 0,this.dragPreviewNode=null,this.dragPreviewRef=null)}get dragSource(){return this.dragSourceNode||this.dragSourceRef&&this.dragSourceRef.current}get dragPreview(){return this.dragPreviewNode||this.dragPreviewRef&&this.dragPreviewRef.current}clearDragSource(){this.dragSourceNode=null,this.dragSourceRef=null}clearDragPreview(){this.dragPreviewNode=null,this.dragPreviewRef=null}constructor(e){this.hooks=He({dragSource:(r,n)=>{this.clearDragSource(),this.dragSourceOptions=n||null,F(r)?this.dragSourceRef=r:this.dragSourceNode=r,this.reconnectDragSource()},dragPreview:(r,n)=>{this.clearDragPreview(),this.dragPreviewOptions=n||null,F(r)?this.dragPreviewRef=r:this.dragPreviewNode=r,this.reconnectDragPreview()}}),this.handlerId=null,this.dragSourceRef=null,this.dragSourceOptionsInternal=null,this.dragPreviewRef=null,this.dragPreviewOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDragSource=null,this.lastConnectedDragSourceOptions=null,this.lastConnectedDragPreview=null,this.lastConnectedDragPreviewOptions=null,this.backend=e}}function R(){const{dragDropManager:t}=i.exports.useContext(Pe);return S(t!=null,"Expected drag drop context"),t}function Ae(t,e){const r=R(),n=i.exports.useMemo(()=>new Ve(r.getBackend()),[r]);return P(()=>(n.dragSourceOptions=t||null,n.reconnect(),()=>n.disconnectDragSource()),[n,t]),P(()=>(n.dragPreviewOptions=e||null,n.reconnect(),()=>n.disconnectDragPreview()),[n,e]),n}function Ue(){const t=R();return i.exports.useMemo(()=>new Ne(t),[t])}class Fe{beginDrag(){const e=this.spec,r=this.monitor;let n=null;return typeof e.item=="object"?n=e.item:typeof e.item=="function"?n=e.item(r):n={},n!=null?n:null}canDrag(){const e=this.spec,r=this.monitor;return typeof e.canDrag=="boolean"?e.canDrag:typeof e.canDrag=="function"?e.canDrag(r):!0}isDragging(e,r){const n=this.spec,o=this.monitor,{isDragging:s}=n;return s?s(o):r===e.getSourceId()}endDrag(){const e=this.spec,r=this.monitor,n=this.connector,{end:o}=e;o&&o(r.getItem(),r),n.reconnect()}constructor(e,r,n){this.spec=e,this.monitor=r,this.connector=n}}function qe(t,e,r){const n=i.exports.useMemo(()=>new Fe(t,e,r),[e,r]);return i.exports.useEffect(()=>{n.spec=t},[t]),n}function Be(t){return i.exports.useMemo(()=>{const e=t.type;return S(e!=null,"spec.type must be defined"),e},[t])}function Ye(t,e,r){const n=R(),o=qe(t,e,r),s=Be(t);P(function(){if(s!=null){const[u,l]=ze(s,o,n);return e.receiveHandlerId(u),r.receiveHandlerId(u),l}},[n,e,r,o,s])}function Ze(t,e){const r=Ee(t,e);S(!r.begin,"useDrag::spec.begin was deprecated in v14. Replace spec.begin() with spec.item(). (see more here - https://react-dnd.github.io/react-dnd/docs/api/use-drag)");const n=Ue(),o=Ae(r.options,r.previewOptions);return Ye(r,n,o),[_e(r.collect,n,o),ke(o),Re(o)]}const Ge={OPERATOR:"Operator"},Je=k((t,{mini:e,readonly:r,type:n,selecting:o})=>({avatarBox:{userSelect:"none",width:e?40:80,minWidth:e?40:80,borderRadius:e?"50%":"20%",overflow:"hidden",position:"relative",zIndex:1,boxShadow:o?"inset 0px 0px 10px 4px "+(n!=="tier-list"?"green":"red"):"inset 0px 0px 10px 4px "+t.colors.gray[5]},nameBox:{position:"absolute",zIndex:2,top:e?"1px":"66px",left:e?"-50%":"0px",width:e?"200%":"100%",display:"flex",alignItems:"center",justifyContent:"center",height:"14px",textAlign:"center",transform:e?"scale(0.5)":"",fontSize:"10px",fontWeight:700,background:"linear-gradient(to top, rgba(255,255,255,0.7) 0%, rgba(255,255,255,0.7) 90%, rgba(255,249,242,0) 100%)"}}));function Ke({sx:t,charKey:e,type:r="default",charStatus:n="default",readonly:o=!e||n==="picked",selecting:s,dragDisabled:a=o||n!=="default"||s,metaInfo:u,charName:l,hidden:c,nameDisplay:d,mini:g,onDelete:v,onSelectChange:p,children:x}){var z;const h=se(()=>r==="tier-list"&&s&&(p==null?void 0:p(!s)),["mouseup","touchend"]),{classes:D}=Je({readonly:o,mini:g,type:r,selecting:s}),{t:m}=Y(),O=Oe(),w={type:r,charKey:e,fromTierValue:u==null?void 0:u.fromTierValue},[{isDragging:y},K]=Ze(()=>({type:Ge.OPERATOR,item:w,canDrag:!a&&!O,collect:$=>({opacity:$.isDragging()?0:1,isDragging:!!$.isDragging()})}),[w,n,o,O,s]),N=i.exports.useMemo(()=>f(oe,{opacity:.6,color:"#000",zIndex:5,sx:{color:"#fff",display:"flex",fontWeight:600,fontSize:g?"10px":"",alignItems:"center",justifyContent:"center"},children:j(b,{children:[y&&m("dragging")||n==="picked"&&m("picked"),s&&r==="tier-list"&&m("charContainer.delete")]})}),[g,y,m,n,s,r]),W=i.exports.useMemo(()=>f(b,{className:D.nameBox,children:l}),[l,D.nameBox]),ee=()=>{o||(s&&r==="tier-list"?v==null||v():n!=="picked"&&(p==null||p(!s)))};return f(b,{ref:h,className:D.avatarBox,sx:{...t,height:c?0:g?40:80},onClick:ee,children:x!=null?x:!c&&j(b,{ref:K,sx:{cursor:o?"":"pointer"},children:[(!(s||n==="default")||y)&&N,s&&r==="tier-list"&&N,d&&W,f(ye,{imgKey:e!=null?e:"",width:g?40:80,flowWidthRef:(z=h.current)!=null?z:void 0})]})})}export{ye as C,pe as D,we as I,Oe as a,Je as b,Pe as c,F as d,R as e,P as f,_e as g,Ee as h,S as i,Ke as j,Ge as k,Xe as r,U as s,se as u,He as w};
